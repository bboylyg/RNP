# RNP
Reconstructive Neuron Pruning for Backdoor Defense (ICML 2023)

# Note
Code is under reorganizing...

# Experimental Results on BadNets Attack  

``

[2023/07/09 22:21:00] - ----------- Data Initialization --------------
==> Preparing train data..
Files already downloaded and verified
full_train: 50000
train_size: 500 drop_size: 49500
==> Preparing test data..
Files already downloaded and verified
Generating testbad Imgs
100%|██████████| 10000/10000 [00:00<00:00, 19826.74it/s]
Injecting Over: 0Bad Imgs, 10000Clean Imgs
  0%|          | 0/10000 [00:00<?, ?it/s]Generating testbad Imgs
 91%|█████████▏| 9144/10000 [00:00<00:00, 14232.94it/s]Injecting Over: 9000Bad Imgs, 1000Clean Imgs
100%|██████████| 10000/10000 [00:00<00:00, 14938.13it/s]


[2023/07/09 22:21:03] - ----------- Backdoor Model Initialization --------------
[2023/07/09 22:21:04] - Epoch 	 lr 	 Time 	 TrainLoss 	 TrainACC 	 PoisonLoss 	 PoisonACC 	 CleanLoss 	 CleanACC
[2023/07/09 22:21:04] - ----------- Model Unlearning --------------
[2023/07/09 22:21:15] - 0 	 0.010 	 11.2 	 0.1004 	 0.9780 	 0.0000 	 1.0000 	 0.2185 	 0.9342
[2023/07/09 22:21:26] - 1 	 0.010 	 10.8 	 0.1213 	 0.9760 	 0.0000 	 1.0000 	 0.2253 	 0.9317
[2023/07/09 22:21:37] - 2 	 0.010 	 10.8 	 0.1400 	 0.9740 	 0.0000 	 1.0000 	 0.2349 	 0.9304
[2023/07/09 22:21:48] - 3 	 0.010 	 10.8 	 0.1535 	 0.9720 	 0.0000 	 1.0000 	 0.2513 	 0.9266
[2023/07/09 22:21:59] - 4 	 0.010 	 10.9 	 0.2078 	 0.9640 	 0.0000 	 1.0000 	 0.2770 	 0.9214
[2023/07/09 22:22:10] - 5 	 0.010 	 11.0 	 0.2614 	 0.9500 	 0.0000 	 1.0000 	 0.3144 	 0.9141
[2023/07/09 22:22:21] - 6 	 0.010 	 10.8 	 0.3711 	 0.9220 	 0.0000 	 1.0000 	 0.3847 	 0.8991
[2023/07/09 22:22:31] - 7 	 0.010 	 10.8 	 0.4538 	 0.8700 	 0.0000 	 1.0000 	 0.5276 	 0.8669
[2023/07/09 22:22:42] - 8 	 0.010 	 10.8 	 0.7916 	 0.6700 	 0.0000 	 1.0000 	 0.9439 	 0.7586
[2023/07/09 22:22:53] - 9 	 0.010 	 10.8 	 1.4771 	 0.4540 	 0.0000 	 1.0000 	 2.5574 	 0.4016
[2023/07/09 22:23:04] - 10 	 0.001 	 10.8 	 3.1028 	 0.2920 	 0.0000 	 1.0000 	 2.5620 	 0.3949
[2023/07/09 22:23:15] - 11 	 0.001 	 10.8 	 4.0416 	 0.2360 	 0.0000 	 1.0000 	 2.8507 	 0.3729
[2023/07/09 22:23:25] - 12 	 0.001 	 10.8 	 4.8811 	 0.1980 	 0.0000 	 1.0000 	 3.2337 	 0.3368
[2023/07/09 22:23:25] - ----------- Model Recovering --------------
Unlearned Model: 12 0.3367777777777778 1.0

[2023/07/09 22:23:26] - Epoch 	 lr 	 Time 	 TrainLoss 	 TrainACC 	 PoisonLoss 	 PoisonACC 	 CleanLoss 	 CleanACC
[2023/07/09 22:23:37] - 1 	 0.200 	 11.0 	 1.0719 	 0.1980 	 0.0000 	 1.0000 	 2.0311 	 0.4370
[2023/07/09 22:23:48] - 2 	 0.200 	 11.0 	 0.9892 	 0.1920 	 0.0000 	 1.0000 	 1.3383 	 0.5432
[2023/07/09 22:23:59] - 3 	 0.200 	 11.0 	 0.7809 	 0.2320 	 0.0018 	 1.0000 	 1.1726 	 0.6138
[2023/07/09 22:24:10] - 4 	 0.200 	 11.0 	 0.4892 	 0.2500 	 0.3161 	 0.8770 	 1.0972 	 0.6552
[2023/07/09 22:24:21] - 5 	 0.200 	 11.1 	 0.4130 	 0.2860 	 0.6548 	 0.6051 	 1.0409 	 0.6662
[2023/07/09 22:24:32] - 6 	 0.200 	 11.0 	 0.3691 	 0.3060 	 0.7871 	 0.5084 	 0.9843 	 0.6822
[2023/07/09 22:24:43] - 7 	 0.200 	 11.0 	 0.3262 	 0.3460 	 0.8479 	 0.4791 	 0.9089 	 0.7053
[2023/07/09 22:24:54] - 8 	 0.200 	 11.0 	 0.2963 	 0.3760 	 0.8369 	 0.4904 	 0.8691 	 0.7157
[2023/07/09 22:25:05] - 9 	 0.200 	 11.0 	 0.2777 	 0.3900 	 0.8192 	 0.5090 	 0.8226 	 0.7324
[2023/07/09 22:25:16] - 10 	 0.200 	 11.0 	 0.2485 	 0.4320 	 0.7842 	 0.5340 	 0.7765 	 0.7497
[2023/07/09 22:25:27] - 11 	 0.200 	 11.0 	 0.2337 	 0.4500 	 0.7554 	 0.5562 	 0.7283 	 0.7666
[2023/07/09 22:25:38] - 12 	 0.200 	 11.0 	 0.2140 	 0.4900 	 0.6922 	 0.6044 	 0.7022 	 0.7752
[2023/07/09 22:25:49] - 13 	 0.200 	 11.0 	 0.2043 	 0.5140 	 0.6542 	 0.6317 	 0.6718 	 0.7870
[2023/07/09 22:26:00] - 14 	 0.200 	 11.0 	 0.1807 	 0.5340 	 0.6128 	 0.6598 	 0.6517 	 0.7951
[2023/07/09 22:26:11] - 15 	 0.200 	 11.0 	 0.1724 	 0.5440 	 0.5820 	 0.6873 	 0.6342 	 0.8018
[2023/07/09 22:26:22] - 16 	 0.200 	 11.0 	 0.1729 	 0.5780 	 0.5754 	 0.6968 	 0.6084 	 0.8121
[2023/07/09 22:26:33] - 17 	 0.200 	 11.1 	 0.1532 	 0.6180 	 0.5683 	 0.7027 	 0.5930 	 0.8176
[2023/07/09 22:26:44] - 18 	 0.200 	 11.0 	 0.1476 	 0.6120 	 0.5614 	 0.7083 	 0.5766 	 0.8244
[2023/07/09 22:26:55] - 19 	 0.200 	 11.0 	 0.1510 	 0.6380 	 0.5674 	 0.7069 	 0.5601 	 0.8312
[2023/07/09 22:27:06] - 20 	 0.200 	 11.1 	 0.1439 	 0.6520 	 0.5788 	 0.6988 	 0.5417 	 0.8402


[2023/07/09 22:27:07] - ----------- Backdoored Model Pruning --------------
[2023/07/09 22:27:07] - No. 	 Layer Name 	 Neuron Idx 	 Mask 	 PoisonLoss 	 PoisonACC 	 CleanLoss 	 CleanACC
[2023/07/09 22:27:17] - 0 	 None     	 None     	 0.0001 	 1.0000 	 0.2157 	 0.9340
[2023/07/09 22:27:27] - 12.00 	 layer4.1.bn2 	 188 	 0.0 	 0.0122 	 0.9986 	 0.2104 	 0.9347
[2023/07/09 22:27:37] - 14.00 	 layer4.1.bn2 	 12 	 0.05 	 0.0139 	 0.9982 	 0.2092 	 0.9340
[2023/07/09 22:27:46] - 18.00 	 layer3.0.bn2 	 230 	 0.1 	 0.0601 	 0.9876 	 0.2065 	 0.9338
[2023/07/09 22:27:56] - 21.00 	 bn1 	 5 	 0.15000000000000002 	 0.9935 	 0.4796 	 0.2074 	 0.9340
[2023/07/09 22:28:06] - 24.00 	 layer4.0.bn2 	 82 	 0.2 	 2.8242 	 0.0661 	 0.2297 	 0.9280
[2023/07/09 22:28:16] - 28.00 	 layer3.0.bn1 	 106 	 0.25 	 3.2791 	 0.0424 	 0.2292 	 0.9270
[2023/07/09 22:28:26] - 32.00 	 layer4.1.bn2 	 152 	 0.30000000000000004 	 4.2908 	 0.0172 	 0.2295 	 0.9277
[2023/07/09 22:28:36] - 41.00 	 layer3.0.bn2 	 97 	 0.35000000000000003 	 5.5764 	 0.0112 	 0.2936 	 0.9094
[2023/07/09 22:28:46] - 49.00 	 layer4.1.bn2 	 451 	 0.4 	 6.3171 	 0.0070 	 0.2963 	 0.9070
[2023/07/09 22:28:56] - 57.00 	 layer4.1.bn2 	 352 	 0.45 	 6.6227 	 0.0059 	 0.2897 	 0.9077
[2023/07/09 22:29:06] - 68.00 	 layer2.0.bn1 	 50 	 0.5 	 6.7961 	 0.0060 	 0.3132 	 0.9012
[2023/07/09 22:29:16] - 82.00 	 layer4.1.bn2 	 86 	 0.55 	 7.0985 	 0.0034 	 0.3194 	 0.8976
[2023/07/09 22:29:26] - 107.00 	 layer4.1.bn2 	 132 	 0.6000000000000001 	 7.2623 	 0.0026 	 0.3248 	 0.8941
[2023/07/09 22:29:36] - 145.00 	 layer4.1.bn2 	 60 	 0.65 	 7.0780 	 0.0021 	 0.5540 	 0.8201
[2023/07/09 22:29:46] - 204.00 	 layer4.1.bn2 	 271 	 0.7000000000000001 	 7.1320 	 0.0011 	 0.5561 	 0.8167
[2023/07/09 22:29:56] - 263.00 	 bn1 	 61 	 0.75 	 6.9168 	 0.0006 	 0.6570 	 0.7844
[2023/07/09 22:30:06] - 365.00 	 layer2.0.bn2 	 80 	 0.8 	 6.8394 	 0.0000 	 0.8824 	 0.7258
[2023/07/09 22:30:17] - 524.00 	 layer2.0.bn2 	 33 	 0.8500000000000001 	 6.8990 	 0.0000 	 1.2204 	 0.6177
[2023/07/09 22:30:28] - 753.00 	 layer3.0.bn2 	 113 	 0.9 	 5.9777 	 0.0000 	 2.0017 	 0.2519
``
